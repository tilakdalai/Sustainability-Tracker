<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sustainability Tracker</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <h1>Sustainability Tracker</h1>
        <p>Track your carbon footprint and optimize your energy use</p>
    </header>
    <main>
        <h2>Enter Your Information</h2>
        <div class="form-container">
            <form id="trackerForm">
                <!-- Transportation Mode -->
                <input type="text" id="transportation" class="input-field"
                    placeholder="Enter transportation mode (e.g., Car)" required>

                <!-- Energy Consumption -->
                <input type="number" id="energyConsumption" class="input-field"
                    placeholder="Enter energy consumption in kWh" required>

                <!-- Destination Location -->
                <input type="text" id="destination" class="input-field" placeholder="Enter destination (e.g., Office)"
                    required>

                <!-- Weather Location -->
                <input type="text" id="weatherLocation" class="input-field" placeholder="Enter city for weather"
                    required>

                <!-- Submit Button -->
                <button type="submit" class="btn">Track Sustainability</button>
            </form>
        </div>

        <div id="results" class="results-container">
            <!-- Results will be dynamically inserted here -->
        </div>
    </main>
    <footer>
        <p>&copy; 2025 Sustainability Tracker. Built for Hackathon.</p>
    </footer>

    <script>
        // API Keys
        const googleMapsApiKey = 'AIzaSyDH3EKfKCv5kblJAKi86Ex9pOX_vajV-oc'; // Google Maps API Key
        const carbonInterfaceApiKey = 'EB5OVMHQCaRuDobUgy2unw'; // Carbon Interface API Key
        const weatherApiKey = '3cf1875151774804a40142844250401'; // WeatherAPI Key

        document.getElementById('trackerForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            // Get user input values
            const transportation = document.getElementById('transportation').value.trim();
            const energyConsumption = document.getElementById('energyConsumption').value.trim();
            const destination = document.getElementById('destination').value.trim();
            const weatherLocation = document.getElementById('weatherLocation').value.trim();

            // Display a loading message
            document.getElementById('results').innerHTML = '<p>Loading data...</p>';

            try {
                // Fetch transportation data from Google Maps API
                const transportationResponse = await fetch(`https://maps.googleapis.com/maps/api/directions/json?origin=${transportation}&destination=${destination}&mode=driving&key=AIzaSyDH3EKfKCv5kblJAKi86Ex9pOX_vajV-oc`);
                const transportationData = await transportationResponse.json();
                console.log('Transportation Data:', transportationData); // Log transportation data

                // Fetch energy data from Carbon Interface API
                const energyResponse = await fetch(`https://api.carboninterface.com/v1/estimate`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${carbonInterfaceApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        "type": "electricity",
                        "consumption": energyConsumption
                    })
                });
                const energyData = await energyResponse.json();
                console.log('Energy Data:', energyData); // Log energy data

                // Fetch weather data from WeatherAPI
                const weatherResponse = await fetch(`https://api.weatherapi.com/v1/current.json?key=${weatherApiKey}&q=${weatherLocation}`);
                const weatherData = await weatherResponse.json();
                console.log('Weather Data:', weatherData); // Log weather data

                // Create result HTML to display data
                const resultHTML = `
                    <div class="result-card">
                        <h3>Transportation Impact</h3>
                        <p>Mode: ${transportation}</p>
                        <p>Emissions: ${transportationData.routes[0].legs[0].distance.text} km</p>
                    </div>
                    <div class="result-card">
                        <h3>Energy Consumption</h3>
                        <p>Consumption: ${energyConsumption} kWh</p>
                        <p>Impact: ${energyData.data.attributes.carbon_footprint} kg of CO2</p>
                    </div>
                    <div class="result-card">
                        <h3>Weather Information</h3>
                        <p>Location: ${weatherLocation}</p>
                        <p>Condition: ${weatherData.current.condition.text}</p>
                        <p>Temperature: ${weatherData.current.temp_c}Â°C</p>
                    </div>
                `;

                // Display results on the page
                document.getElementById('results').innerHTML = resultHTML;
            } catch (error) {
                document.getElementById('results').innerHTML = '<p>Error fetching data. Please try again.</p>';
                console.error('Error fetching data:', error);
            }
        });
    </script>
</body>

</html>